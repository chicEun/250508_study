## transferFrom()

transferFrom()은 토큰을 다른 계정으로부터 내가 대신해서 꺼내오는 동작이다
즉, 승인된 제3자 또는 스마트 컨트랙트가 토큰 소유자의 자산을 직접 '끌어와서' 사용하는 구조에서 사용

| 구분               | 설명                                                                                          |
| ---------------- | --------------------------------------------------------------------------------------------- |
| `transfer()`     | **직접 전송**: 토큰 소유자가 자기가 가진 토큰을 **직접 상대방에게 전송**함                                    |
| `transferFrom()` | **간접 전송**: 토큰 소유자가 **누군가에게 "내 토큰을 꺼내가도 된다"고 승인**하고, 제3자가 **그 토큰을 꺼내가는** 방식 |


## transfer() vs transferFrom() 비교

| 항목         | `transfer()`          | `transferFrom()`                   |
| ---------- | --------------------- | ---------------------------------- |
| 주체         | **토큰 소유자 본인**이 직접 호출  | **다른 사람** (컨트랙트 또는 위임받은 제3자)이 호출   |
| 사용 전 승인 필요 | ❌ 없음                  | ✅ `approve()`로 사전 승인 필요            |
| 용도         | 단순한 송금, 유저가 직접 보내는 경우 | 자동화된 거래, 마켓, 스왑 등에서 사용             |
| 예시         | Alice → Bob 직접 전송     | OpenSea 컨트랙트가 Alice → Bob으로 NFT 이동 |
| 권한 흐름      | "내가 내 돈 보내는 구조"       | "남이 내 돈 꺼내 쓰는 구조 (내가 허락한 범위 내)"    |


## 왜 굳이 다른 사람이 내 토큰 가져가게함??

1. 자동화된 시스템
    예: Uniswap에서 스왑을 할 때,
    Uniswap 컨트랙트가 내 토큰을 꺼내가서 ETH로 바꿔줌

    만약 transfer()만 있다면?
    → 사용자 본인이 먼저 수동으로 보내고, 그 다음 동작이 이루어져야 함
    → 매우 불편 + 보안 리스크 증가

 2. 마켓플레이스 거래 구조
    예: OpenSea에서 NFT 판매 등록 시

    판매자가 NFT를 escrow에 미리 보내지 않음

    → 대신 approve(marketplace, tokenId) 호출

    구매자가 나타나면 marketplace 컨트랙트가 대신 transferFrom(seller, buyer, tokenId) 실행
    → 거래가 자동으로 성사됨 (탈중앙 구조 유지)

## 흐름 비교: 유저 직접 전송 vs 컨트랙트 자동 추출

# 유저가 직접 전송하는 경우 (transfer() 사용)

Alice가 Bob에게 직접 송금

transfer(bob, 10) 호출

블록체인에서 Alice의 잔고에서 -10, Bob에 +10

→ 본인의 지갑으로 직접 전송 아주 단순한 구조
컨트랙트도 필요 없고 승인도 필요 없음

# 컨트랙트가 대신 토큰 가져가는 경우 (approve() + transferFrom() )
Alice가 Uniswap에 100 토큰 사용 허용
→ approve(uniswap, 100)

Uniswap이 스왑 로직 실행
→ 내부에서 transferFrom(alice, uniswap, 50)

가져온 50 토큰을 Uniswap 풀에 넣고 ETH 반환

→ 이 구조가 있어야 자동화 가능
→ 컨트랙트가 내 자산을 꺼내 실행할 수 있음
--------------------------------------------------------------------------
Alice가 OpenSea에 자신의 NFT를 판매로 등록

구매자가 나타나면, OpenSea 컨트랙트가 자동으로 Alice의 NFT를 구매자에게 전송해야 함

그런데 NFT는 자산이기 때문에, OpenSea가 Alice의 자산을 마음대로 꺼내가면 안됨

그래서 Alice는 다음과 같이 **사전 허락(승인)**을 해줘야 함

→ 이 승인이 있어야, OpenSea가 다음과 같은 호출을 할 수 있습니다:

이게 왜 중요?
OpenSea는 수천 개의 NFT를 중개함
사용자가 직접 transfer()를 하면 중앙화된 처리처럼 되어버린다

대신, approve() + transferFrom() 구조를 통해,
스마트 컨트랙트가 자동으로 중개하고 처리할 수 있는 구조가 만들어짐

# approve + transferFrom 구조 흐름 그림

사용자(Alice)
   │
   ├─▶ 1. approve(spender, amount)
   │        └── 컨트랙트에게 토큰을 특정 개수까지 꺼낼 수 있도록 승인
   │
컨트랙트(Uniswap 또는 OpenSea)
   │
   ├─▶ 2. transferFrom(alice, to, amount)
   │        └── 실제로 사용자의 토큰을 가져와서 처리
   │

# 필요이유

| 구분        | 이유                                                |
| --------- | --------------------------------------------------- |
| ✔ 자동화     | 유저가 수동으로 보내지 않아도 컨트랙트가 자동 처리 가능         |
| ✔ 위임      | 사용자가 특정 컨트랙트에게 권한을 위임할 수 있음               |
| ✔ 보안성     | 허용된 범위만 꺼낼 수 있음 (`approve`로 제한)              |
| ✔ dApp 필수 | 마켓플레이스, 자동 스왑, 정기 결제 등 **탈중앙 앱의 핵심 기반** |


# allowance()도 함께 이해해야 좋음

approve(spender, amount) → 누구에게 얼마나 꺼내갈 수 있도록 허락했는가

allowance(owner, spender) → 승인된 양을 조회

transferFrom(owner, to, amount) → 실사용 시 실행
